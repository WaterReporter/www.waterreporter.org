<div id="map--wrapper" class="map--wrapper" data-ng-if="page.map.geojson.reports.data.features.length && page.search.data.features.length">

  <leaflet id="map" class="map map--hero" markers="page.map.markers"
           data-ng-if="page.map.geojson.reports.data.features.length && page.search.data.features.length"
           defaults="page.map.defaults" layers="page.map.layers"
           center="page.map.center" bounds="page.map.bounds">
  </leaflet>

  <div  data-ng-if="page.map.geojson.reports.data.features.length && page.search.data.features.length" id="map--vignette" class="map--vignette" data-ng-click="page.hideVignette()">
  </div>

  <div  data-ng-if="page.map.geojson.reports.data.features.length && page.search.data.features.length" id="map--featured" class="map--featured" data-ng-if="page.map.geojson.reports.data.features.length">
    <div class="features--container" data-ng-show="page.features.visible === $index"
         data-ng-repeat="report in page.map.geojson.reports.data.features track by $index">
      <div class="features--report"
           data-ng-swipe-left="page.changeFeature(page.map.geojson.reports.data.features[$index+1], $index+1)"
           data-ng-swipe-right="page.changeFeature(page.map.geojson.reports.data.features[$index-1], $index-1)">
        <div data-ng-include="'/modules/shared/views/feature--view.html'"></div>
      </div>
    </div>
  </div>

</div>

<nav data-ng-if="page.map.geojson.reports.data.features.length && page.search.data.features.length" class="features--navigation">
  <ul>
    <li data-ng-if="report.properties.is_featured"
        data-ng-repeat="report in page.map.geojson.reports.data.features track by $index">
      <a href="javascript:void(0);" data-ng-class="{ 'active': page.features.visible === $index }"
         data-ng-click="page.changeFeature(page.map.geojson.reports.data.features[$index], $index)">
        {{ $index }}
      </a>
    </li>
  </ul>
</nav>
