<div data-ng-include="'/modules/shared/views/header--view.html'"></div>

<form class="site--search site--search--content" role="form" id="form--search--reports" name="form--search--reports">
  <div class="form-control">
    <input type="text" id="form--search--reportDescription" name="form--search--reportDescription" data-ng-model="activity.search.params.report_description" data-ng-change="activity.search.execute()" autofocus="autofocus" />
  </div>
</form>

<main class="site--content site--content--activity">
  <aside class="site--content--statistics">
    <ul data-ng-if="activity.search.data.properties.num_results !== undefined">
      <li>
        <a href="/activity/">{{ activity.search.data.properties.num_results | number:0 }} Reports</a>
      </li>
      <li>
        <a href='/activity/?q={"filters":[{"name":"state","op":"eq","val":"open"}]}'>--- Open</a>
      </li>
      <li>
        <a href='/activity/?q={"filters":[{"name":"state","op":"eq","val":"closed"}]}'>--- Closed</a>
      </li>
    </ul>
  </aside>

  <div class="container" search-scroll-to-load="activity.search.autoload()">

    <!-- Untruthy Result Set (0) -->
    <div class="row" data-ng-if="!activity.search.data.features.length">
      <div class="col-sm-12">
      <p>Your search didnâ€™t return any reports</p>
      </div>
    </div>

    <!-- Truthy Result Set (1+) -->
    <div class="row"
         data-ng-if="activity.search.data.features.length"
         data-ng-repeat="report in activity.search.data.features">
      <div id="report--{{ report.properties.id }}" class="col-sm-12" data-ng-class="{'report--state--open': (report.properties.state === 'open'), 'report--state--closed': (report.properties.state === 'closed') }">
        <p>{{ report.properties.owner.properties.first_name }} {{ report.properties.owner.properties.last_name }}</p>
        <p>
          {{ report.properties.owner.properties.title }} <span data-ng-if="report.properties.owner.properties.title && report.properties.owner.properties.organization_name">at</span><br data-ng-if="report.properties.owner.properties.title && report.properties.owner.properties.organization_name" />
          {{ report.properties.owner.properties.organization_name }}
        </p>
        <p>{{ report.properties.report_date | date:"MMM d, yyyy"}}</p>

        <figure data-ng-if="report.properties.images && report.properties.images.length">
<!--           <img photoio photoio-u="image.properties.original" photoio-w="640" photoio-h="640" photoio-mode="crop" data-ng-repeat="image in report.properties.images" /> -->
          <img data-ng-src="{{ image.properties.original }}" width="640" data-ng-repeat="image in report.properties.images" />
        </figure>

        <p>{{ report.properties.report_description }}</p>

        <ul data-ng-if="report.properties.tags.length">
          <li data-ng-repeat="tag in report.properties.tags">
            <a href="" data-ng-click="activity.search.hashtag(tag.properties.tag, 'report_description')">
              #{{ tag.properties.tag }}
            </a>
          </li>
        </ul>

        <p>
          {{ report.geometry.geometries[0].coordinates[0] }}<br />
          {{ report.geometry.geometries[0].coordinates[1] }}
        </p>
      </div>
    </div>

    <!-- Load More Results -->
    <div class="row">
      <div class="col-sm-12">
        <!-- <a data-ng-click="activity.search.autoload()" class="button">Load More</a> -->
      </div>
    </div>

    <footer class="features-footer">
      <nav class="pager" data-ng-if="activity.search.data.properties.page === 1 && activity.search.data.properties.total_pages === 1">
        <!-- If your on Page 1 and there's less than or equal to 10 results total -->
        <span class="page">
          Showing all {{ activity.search.data.properties.num_results }} reports
        </span>
      </nav>
      <nav class="pager" data-ng-if="activity.search.data.properties.total_pages > 1">
        <a data-ng-show="activity.search.data.properties.total_pages >= activity.search.data.properties.page && activity.search.data.properties.page !== 1" href="javascript:void(0);" data-ng-click="activity.search.paginate(activity.search.data.properties.page-1)" class="previous">
          Previous
        </a>
        <span data-ng-show="!activity.paginationLabel" data-ng-click="activity.paginationLabel =! activity.paginationLabel" class="page">Page {{ activity.search.data.properties.page }} of {{ activity.search.data.properties.total_pages }}</span>
        <span data-ng-show="activity.paginationLabel" data-ng-click="activity.paginationLabel =! activity.paginationLabel" class="page">
          <span data-ng-if="activity.search.data.properties.page === 1 && activity.search.data.properties.total_pages > 1">
            Showing 1 - 10 of {{ activity.search.data.properties.num_results | number:0 }} reports
          </span>

          <span data-ng-if="activity.search.data.properties.page > 1 && activity.search.data.properties.page !== activity.search.data.properties.total_pages">
            Showing <span data-ng-bind="((activity.search.data.properties.page-1)*10+1)"></span> - <span data-ng-bind="activity.search.data.properties.page*10"></span> of {{ activity.search.data.properties.num_results | number:0 }} reports
          </span>

          <span data-ng-if="activity.search.data.properties.page > 1 && activity.search.data.properties.page === activity.search.data.properties.total_pages">
            Showing <span data-ng-bind="((activity.search.data.properties.page-1)*10+1)"></span> - {{ activity.search.data.properties.num_results }} of {{ activity.search.data.properties.num_results | number:0 }} reports
          </span>
        </span>
        <a data-ng-show="activity.search.data.properties.total_pages !== activity.search.data.properties.page" href="javascript:void(0);" data-ng-click="activity.search.paginate(activity.search.data.properties.page+1)" class="next">
          Next
        </a>
      </nav>
    </footer>

  </div>
</main>

<div data-ng-include="'/modules/shared/views/footer--view.html'"></div>